<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jeric POS - Login / Register</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
body { font-family:'Poppins',sans-serif; background:#0a1a22; color:#fff; margin:0; display:flex; justify-content:center; align-items:center; height:100vh; }
.container { background:rgba(255,255,255,0.05); padding:30px; border-radius:10px; width:350px; box-shadow:0 0 20px rgba(0,255,204,0.2); }
h2 { color:#00ffcc; text-align:center; margin-bottom:20px; }
input { width:100%; padding:10px; margin:8px 0; border-radius:6px; border:1px solid rgba(255,255,255,0.15); background:rgba(255,255,255,0.05); color:#fff; }
button { width:100%; padding:10px; border:none; border-radius:6px; margin-top:10px; font-weight:600; cursor:pointer; }
.primary { background:#00ffcc; color:#000; }
.danger { background:#ff4d4d; color:#fff; }
.toggle { text-align:center; margin-top:10px; cursor:pointer; color:#00ffcc; text-decoration:underline; }
.message { text-align:center; margin-top:10px; color:#ff4d4d; }
</style>
</head>
<body>
<div class="container">
  <h2 id="formTitle">Login</h2>

  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button id="submitBtn" class="primary">Login</button>

  <div class="toggle" id="toggleForm">Don't have an account? Register</div>
  <div class="message" id="message"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDd_04phC5KuoSnpC-mg6ASGFlRVX_d4Dk",
  authDomain: "jeric-pos.firebaseapp.com",
  projectId: "jeric-pos",
  storageBucket: "jeric-pos.appspot.com",
  messagingSenderId: "294868456105",
  appId: "1:294868456105:web:03c3e18a7037afbad80fb8"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();

let isLogin=true;

const formTitle=document.getElementById("formTitle");
const submitBtn=document.getElementById("submitBtn");
const toggleForm=document.getElementById("toggleForm");
const messageDiv=document.getElementById("message");

toggleForm.onclick=()=>{
  isLogin=!isLogin;
  formTitle.textContent=isLogin?"Login":"Register";
  submitBtn.textContent=isLogin?"Login":"Register";
  toggleForm.textContent=isLogin?"Don't have an account? Register":"Already have an account? Login";
  messageDiv.textContent="";
};

submitBtn.onclick=async ()=>{
  const email=document.getElementById("email").value.trim();
  const password=document.getElementById("password").value.trim();
  if(!email || !password){ messageDiv.textContent="Fill in all fields"; return; }

  try{
    if(isLogin){
      const userCred=await auth.signInWithEmailAndPassword(email,password);
      const doc=await db.collection("users").doc(userCred.user.uid).get();
      if(doc.exists && doc.data().role==="admin"){ location.href="admin.html"; }
      else{ location.href="shop.html"; }
    }else{
      const userCred=await auth.createUserWithEmailAndPassword(email,password);
      await db.collection("users").doc(userCred.user.uid).set({
        email, role:"customer", createdAt:firebase.firestore.FieldValue.serverTimestamp()
      });
      messageDiv.style.color="#00ffcc";
      messageDiv.textContent="Account created! You can now login.";
      isLogin=true; formTitle.textContent="Login"; submitBtn.textContent="Login"; toggleForm.textContent="Don't have an account? Register";
    }
  }catch(e){
    console.error(e);
    messageDiv.style.color="#ff4d4d";
    messageDiv.textContent=e.message;
  }
};
</script>
</body>
</html>
